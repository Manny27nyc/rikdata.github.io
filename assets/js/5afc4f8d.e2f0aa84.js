"use strict";(self.webpackChunkinoerp=self.webpackChunkinoerp||[]).push([[9886],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return f}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var o=r.createContext({}),u=function(e){var t=r.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=u(e.components);return r.createElement(o.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,s=e.originalType,o=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),d=u(n),f=a,h=d["".concat(o,".").concat(f)]||d[f]||c[f]||s;return n?r.createElement(h,l(l({ref:t},p),{},{components:n})):r.createElement(h,l({ref:t},p))}));function f(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var s=n.length,l=new Array(s);l[0]=d;var i={};for(var o in t)hasOwnProperty.call(t,o)&&(i[o]=t[o]);i.originalType=e,i.mdxType="string"==typeof e?e:a,l[1]=i;for(var u=2;u<s;u++)l[u]=n[u];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},855:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return i},contentTitle:function(){return o},metadata:function(){return u},toc:function(){return p},default:function(){return d}});var r=n(7462),a=n(3366),s=(n(7294),n(3905)),l=["components"],i={id:"server",title:"Server Side Customization",sidebar_label:"Server"},o=void 0,u={unversionedId:"customization/server",id:"customization/server",title:"Server Side Customization",description:"OneApp is a flexible application, and you can map various business requirements using correct configurations. However, in case of any unique requirements, the application also provides well-structured JavaScript APIs that you can use to customize the application. You can customize the application either on the server side (an application that uses RikData Rest Builder) or on the client-side.",source:"@site/docs/customization/server.md",sourceDirName:"customization",slug:"/customization/server",permalink:"/docs/customization/server",editUrl:"https://github.com/rikdata/rikdata.github.io/edit/main/src/docs/docs/customization/server.md",tags:[],version:"current",frontMatter:{id:"server",title:"Server Side Customization",sidebar_label:"Server"},sidebar:"mySidebar",previous:{title:"Salesforce Default Config",permalink:"/docs/admin/default-config-sforce"},next:{title:"Client",permalink:"/docs/customization/client"}},p=[{value:"Triggers/Connection Points",id:"triggersconnection-points",children:[],level:2},{value:"Global Methods",id:"global-methods",children:[{value:"REST",id:"rest",children:[],level:3},{value:"SQL",id:"sql",children:[],level:3}],level:2},{value:"Examples",id:"examples",children:[{value:"Remove fields from REST result",id:"remove-fields-from-rest-result",children:[],level:3},{value:"Validate a field",id:"validate-a-field",children:[],level:3},{value:"REST Requests",id:"rest-requests",children:[],level:3},{value:"SQL Requests",id:"sql-requests",children:[{value:"sqlSelect",id:"sqlselect",children:[],level:4},{value:"sqlUpdate",id:"sqlupdate",children:[],level:4},{value:"sqlInsert",id:"sqlinsert",children:[],level:4},{value:"sqlDelete",id:"sqldelete",children:[],level:4}],level:3}],level:2}],c={toc:p};function d(e){var t=e.components,n=(0,a.Z)(e,l);return(0,s.kt)("wrapper",(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("p",null,"OneApp is a flexible application, and you can map various business requirements using correct configurations. However, in case of any unique requirements, the application also provides well-structured JavaScript APIs that you can use to customize the application. You can customize the application either on the server side (an application that uses RikData Rest Builder) or on the client-side."),(0,s.kt)("p",null,"On the server side, the application provides eight connection/trigger points and 9 Global Methods."),(0,s.kt)("h2",{id:"triggersconnection-points"},"Triggers/Connection Points"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"BeforeGet : Called before Get requests "),(0,s.kt)("li",{parentName:"ul"},"AfterGet : Called after Get requests"),(0,s.kt)("li",{parentName:"ul"},"BeforePatch : Called before Patch requests"),(0,s.kt)("li",{parentName:"ul"},"AfterPatch : Called after Patch requests"),(0,s.kt)("li",{parentName:"ul"},"BeforePost : Called before Post requests"),(0,s.kt)("li",{parentName:"ul"},"AfterPost : Called after Post requests"),(0,s.kt)("li",{parentName:"ul"},"BeforeDelete : Called before Delete requests"),(0,s.kt)("li",{parentName:"ul"},"AfterDelete : Called after Delete requests")),(0,s.kt)("h2",{id:"global-methods"},"Global Methods"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"consoleLog")),(0,s.kt)("h3",{id:"rest"},"REST"),(0,s.kt)("p",null,"Can be used for both internal and external applications"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"restGet"),(0,s.kt)("li",{parentName:"ul"},"restPost"),(0,s.kt)("li",{parentName:"ul"},"restPatch"),(0,s.kt)("li",{parentName:"ul"},"restDelete")),(0,s.kt)("h3",{id:"sql"},"SQL"),(0,s.kt)("p",null,"Available only for internal applications"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"sqlSelect"),(0,s.kt)("li",{parentName:"ul"},"sqlInsert"),(0,s.kt)("li",{parentName:"ul"},"sqlUpdate"),(0,s.kt)("li",{parentName:"ul"},"sqlDelete")),(0,s.kt)("h2",{id:"examples"},"Examples"),(0,s.kt)("h3",{id:"remove-fields-from-rest-result"},"Remove fields from REST result"),(0,s.kt)("p",null,"Several applications (such as ServiceNow) show user passwords when you fetch user records using REST APIs. Though the passwords are encoded and not usable, you probably want to remove them from the user interface. (This is just for illustration purposes. We can hide any field in the application just by configuration. No need to write any custom javascript code.)"),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},"First, define a function to remove password from the REST result")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'      // For illustration purpose, showing  all possible options. Not the best way to remove a field\n            function removePassword(inputData) {\n            if (typeof inputData === "string") {\n                allData = JSON.parse(inputData);\n            } else {\n                allData = inputData;\n            }\n            let data = allData["data"];\n\n            if (Array.isArray(data)) {\n                let retData = new Array();\n                for (let i = 0; i < data.length; i++) {\n                let e = data[i];\n                let newObj = new Object();\n                for (var k in e) {\n                    if (k !== "password") {\n                    newObj[k] = e[k];\n                    }\n                }\n                retData.push(newObj);\n                }\n                return retData;\n            } else {\n                let newObj = new Object();\n                for (var k in data) {\n                if (k !== "password") {\n                    newObj[k] = data[k];\n                }\n                }\n                return newObj;\n            }\n            }\n')),(0,s.kt)("ol",{start:2},(0,s.kt)("li",{parentName:"ol"},"Add the above function to the main method specifying the function trigger point.")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'   function main(){\n        let allMethods =  {\n            "RdSecUser" : {\n                "afterGet" : ["user/user.js","removePassword"],\n                "BeforePatch" : ["user/user.js","validatePassword"],\n                "BeforePost" : ["user/user.js","validatePassword"],\n            },\n            "RdSecRole" : {\n                "BeforeGet" : ["user/user.js","validatePassword"],\n                "AfterGet" : ["user/user.js","validatePassword"],\n                "BeforePatch" : ["user/user.js","validatePassword"],\n                "AfterPatch" : ["user/user.js","validatePassword"],\n                "BeforePost" : ["user/user.js","validatePassword"],\n                "AfterPost" : ["user/user.js","validatePassword"],\n                "BeforeDelete" : ["user/user.js","validatePassword"],\n                "AfterDelete" : ["user/user.js","validatePassword"],\n            },\n        };\n\n        return allMethods;\n} \n')),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("p",{parentName:"li"},"RdSecUser: The entity name")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("p",{parentName:"li"},"afterGet : The trigger/call point")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("p",{parentName:"li"},"user/user.js : JavaScript file path")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("p",{parentName:"li"},"removePassword: Function that is called for RdSecUser after Get Request from the user.js file")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("p",{parentName:"li"},"*Put your main.js file in assets\\js\\config folder. "))),(0,s.kt)("p",null,"Relative to the application execution file "),(0,s.kt)("h3",{id:"validate-a-field"},"Validate a field"),(0,s.kt)("p",null,"It's a standard practice to let a user enter the password field twice to update her/his password. To validate the user entered the same value in two fields, you can use a simple function like below."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'function validatePassword(data) {\n  try {\n    if (data["password"] === data["confirmPassword"]) {\n      return true;\n    } else {\n      return false;\n    }\n  } catch (error) {\n    return error;\n  }\n}\n')),(0,s.kt)("h3",{id:"rest-requests"},"REST Requests"),(0,s.kt)("p",null,"Below are examples of how to use global REST functions"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'\nconst restRequestType = {\n  get: "get",\n  post: "post",\n  patch: "patch",\n  delete: "delete",\n};\n\nObject.freeze(restRequestType);\n\n\nfunction getRequest(inputData) {\n  let newRequest = {\n    host: "http://localhost:8085/api/ierp/Subinventory(subinventoryId=43)",\n  };\n  return restRequest(inputData, restRequestType.get, newRequest);\n}\n\nfunction patchRequest(inputData) {\n  let content = {\n    description: "Raw TestSub03 id 46",\n  };\n  let newRequest = {\n    host: "http://localhost:8085/api/ierp/Subinventory(subinventoryId=46)",\n    content: content,\n  };\n  return restRequest(inputData, restRequestType.patch, newRequest);\n}\n\nfunction deleteRequest(inputData) {\n  let newRequest = {\n    host: "http://localhost:8085/api/ierp/Subinventory(subinventoryId=47)"\n    };\n  return restRequest(inputData, restRequestType.delete, newRequest);\n}\n\nfunction postRequest(inputData) {\n  let content = {\n    "subinventory": "TestSub03",\n    "description": "TestSub03 desc",\n    "type": "RAW",\n    "locatorControl": "DYNAMIC_ENTRY",\n    "orgId": "6",\n    "materialAcId": "2",\n    "materialOhAcId": "3",\n    "ospAcId": "4",\n    "overheadAcId": "5",\n    "resourceAcId": "6",\n    "lastUpdateBy" : "34",\n    "createdBy" : "34",\n  };\n  let newRequest = {\n    host: "http://localhost:8085/api/ierp/Subinventory",\n    content: content,\n  };\n  return restRequest(inputData, restRequestType.post, newRequest);\n}\n\n')),(0,s.kt)("p",null,"All these examples are only for illustration purposes.\nFor internal applications, you can use the Authorization details available in the input map. For external applications, use correct credentials as required."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'function restRequest(inputData, type, newRequest) {\n  let allData;\n  if (typeof inputData === "string") {\n    allData = JSON.parse(inputData);\n  } else {\n    allData = inputData;\n  }\n\n  let data = allData["data"];\n  let requestData = allData["request"];\n  if ("Authorization" in requestData) {\n    newRequest["authorization"] = requestData["Authorization"];\n  }\n  \n  let response;\n  switch (type) {\n     case restRequestType.post:\n      response = restPost(newRequest);\n      break;\n    case restRequestType.patch:\n      response = restPatch(newRequest);\n      break;\n    case restRequestType.delete:\n      response = restDelete(newRequest);\n      break;\n    case restRequestType.get:\n    default:\n      response = restGet(newRequest);\n      break;\n  }\n\n  let body = response.body;\n  if (typeof body === "string") {\n    body = JSON.parse(response);\n  }\n\n  if (Array.isArray(body)) {\n    for (let i = 0; i < body.length; i++) {\n      let e = body[i];\n      printNestedObject(e);\n    }\n  } else {\n    printNestedObject(body);\n  }\n} \n\n\n\n')),(0,s.kt)("p",null,"Any function defined in the global space (main.js file) is available in all other files. So, you can define global functions such as the printNestedObject function in the main.js file."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'function printNestedObject(obj) {\n  if (typeof obj === "string") {\n    consoleLog(obj);\n  } else if (Object.keys(obj).length > 0) {\n    let allKeys = Object.keys(obj);\n    for (let i = 0; i < allKeys.length; i++) {\n      const k = allKeys[i];\n      consoleLog(k + " : " + obj[k]);\n      if (typeof obj[k] === "object" && Object.keys(obj[k]).length > 0) {\n        printNestedObject(obj[k]);\n      }\n    }\n  }\n}\n')),(0,s.kt)("h3",{id:"sql-requests"},"SQL Requests"),(0,s.kt)("p",null,"For internal applications, you can directly use SQL to Insert/Update/Delete various records. All the SQL statements used in REST APIs are parametrized. However, SQL requests are not. So, sanitize any user data before writing raw SQL statements."),(0,s.kt)("h4",{id:"sqlselect"},"sqlSelect"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'function sqlQueryTest(inputData) {\n  request = {\n    sql: "SELECT * from sys_value_group_header",\n    dbType: "MySQL",\n    connName: "password",\n  };\n\n  let response = sqlSelect(request);\n  printNestedObject(response.data);\n}\n')),(0,s.kt)("h4",{id:"sqlupdate"},"sqlUpdate"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'function sqlUpdateTest(inputData) {\n  request = {\n    sql: "UPDATE sys_value_group_header SET description = \'TEST Value Group03 With id 21\' WHERE sys_value_group_header_id = \'21\' ",\n    dbType: "MySQL",\n    connName: "password",\n  };\n\n  let response = sqlUpdate(request);\n  printNestedObject(response.data);\n}\n')),(0,s.kt)("h4",{id:"sqlinsert"},"sqlInsert"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"function sqlInsertTest(inputData) {\n  let sql =\n    \"INSERT INTO sys_value_group_header (value_group, description, access_level, validation_type, created_by,last_update_by) \";\n  sql +=\n    \" VALUES ('TEST_VG04', 'TEST Value Group04', 'user', 'NONE', '1', '1' ) \";\n  request = {\n    sql: sql,\n    dbType: \"MySQL\",\n    connName: \"password\",\n  };\n\n  let response = sqlInsert(request);\n  printNestedObject(response.data);\n}\n")),(0,s.kt)("h4",{id:"sqldelete"},"sqlDelete"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'function sqlDeleteTest(inputData) {\n  request = {\n    sql: "DELETE FROM sys_value_group_header WHERE sys_value_group_header_id = \'28\' ",\n    dbType: "MySQL",\n    connName: "password",\n  };\n\n  let response = sqlDelete(request);\n  printNestedObject(response.data);\n}\n')))}d.isMDXComponent=!0}}]);